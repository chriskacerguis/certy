<h2>Revoke Certificate</h2>
<p class="text-muted">Revocation is <em>passive</em> in step-ca: revoked certs cannot be renewed and will expire normally. Authenticate via mTLS (cert+key) or by serial with a provisioner token.</p>
<form method="post" action="/certs/revoke" class="row g-3">
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
  <div class="col-12">
    <label class="form-label">Certificate (PEM) — required</label>
    <textarea name="certPem" class="form-control" rows="8" placeholder="-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----" required></textarea>
  </div>
  <div class="col-12">
    <label class="form-label">Private Key (PEM) — optional (for mTLS)</label>
    <textarea name="keyPem" class="form-control" rows="10" placeholder="-----BEGIN PRIVATE KEY-----
...
-----END PRIVATE KEY-----"></textarea>
  </div>
  <div class="col-md-6">
    <label class="form-label">Reason (optional)</label>
    <input class="form-control" name="reason" placeholder="key compromise">
  </div>
  <div class="col-md-6">
    <label class="form-label">Reason Code</label>
    <select class="form-select" name="reasonCode">
      <option value="0">unspecified (0)</option>
      <option value="1">keyCompromise (1)</option>
      <option value="2">cACompromise (2)</option>
      <option value="3">affiliationChanged (3)</option>
      <option value="4">superseded (4)</option>
      <option value="5">cessationOfOperation (5)</option>
      <option value="6">certificateHold (6)</option>
      <option value="8">removeFromCRL (8)</option>
      <option value="9">privilegeWithdrawn (9)</option>
      <option value="10">aACompromise (10)</option>
    </select>
  </div>
    <hr>
  <div class="col-12">
    <button class="btn btn-warning" type="submit">Revoke Certificate</button>
  </div>
</form>
